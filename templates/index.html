{% extends "base.html" %}
{% block content %}

<section class="panel">
    <form class="filters" hx-get="/partials/table" hx-target="#table" hx-trigger="keyup changed delay:300ms, change"
        onsubmit="return false;">
        <input type="text" name="q" placeholder="Search (LM358, ADS1115, BX-03…)" value="{{ q }}" />

        <select name="category">
            <option value="">All categories</option>
            {% for c in categories %}
            <option value="{{ c }}" {% if c==category %}selected{% endif %}>{{ c }}</option>
            {% endfor %}
        </select>

        <select name="container_id">
            <option value="">All containers</option>
            {% for c in containers %}
            <option value="{{ c }}" {% if c==container_id %}selected{% endif %}>{{ c }}</option>
            {% endfor %}
        </select>

        <a class="btn"
            href="/export.csv?q={{ q|urlencode }}&category={{ category|urlencode }}&container_id={{ container_id|urlencode }}">Export
            CSV</a>
    </form>
</section>

<section class="panel">
    <form class="add" hx-post="/parts" hx-target="#table" hx-swap="innerHTML">
        <input name="category"
               placeholder="Category (IC, MCU, PASSIVE…)"
               list="dl-categories"
               autocomplete="off"
               spellcheck="false"
               title="What kind of item this is physically (IC, board, module, passive)."
               required />

        <input name="subcategory"
               placeholder="Subcategory (OpAmp, Logic…)"
               list="dl-subcategories"
               autocomplete="off"
               spellcheck="false"
               title="Optional technical role or family (MCU, OpAmp, DC/DC, Encoder)." />

        <input name="description"
               placeholder="Description (LM358 DIP, ADS1115 board…)"
               title="What you will actually search for (MPN, package, key detail)."
               required />

        <input name="package"
               placeholder="Package (DIP, SOIC, Module…)"
               title="Physical form factor (DIP, SOIC, 0603, Module)." />

        <input name="container_id"
               placeholder="Container (BX-03, DR-01…)"
               list="dl-containers"
               autocomplete="off"
               spellcheck="false"
               title="Physical storage location (box, drawer, compartment)." />

        <input name="quantity"
               type="number"
               min="0"
               value="0"
               title="Approximate stock count (can be updated anytime)." />

        <input name="notes"
               placeholder="Notes (optional)"
               title="Free text for anything that doesn't fit elsewhere." />

        <button class="btn" type="submit">Add</button>
    </form>

    <!-- Suggestions -->
    <datalist id="dl-categories">
        {% for cat in categories %}
        <option value="{{ cat }}"></option>
        {% endfor %}
    </datalist>

    <datalist id="dl-containers">
        {% for c in containers %}
        <option value="{{ c }}"></option>
        {% endfor %}
    </datalist>

    <datalist id="dl-subcategories">
        {% for s in subcategories %}
        <option value="{{ s }}"></option>
        {% endfor %}
    </datalist>

</section>

<section class="panel" id="table">
    {% include "_table.html" %}
</section>

{% endblock %}